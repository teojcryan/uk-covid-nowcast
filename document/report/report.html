<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.619">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ryan Teo">

<title>Nowcasting COVID-19 incidence in England</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"> <span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"> <span class="header-section-number">2</span> Methods</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"> <span class="header-section-number">2.1</span> Data</a></li>
  <li><a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models"> <span class="header-section-number">2.2</span> Models</a>
  <ul class="collapse">
  <li><a href="#expected-final-notifications" id="toc-expected-final-notifications" class="nav-link" data-scroll-target="#expected-final-notifications"> <span class="header-section-number">2.2.1</span> Expected final notifications</a></li>
  <li><a href="#delay-distribution" id="toc-delay-distribution" class="nav-link" data-scroll-target="#delay-distribution"> <span class="header-section-number">2.2.2</span> Delay distribution</a></li>
  <li><a href="#observation-model-and-nowcast" id="toc-observation-model-and-nowcast" class="nav-link" data-scroll-target="#observation-model-and-nowcast"> <span class="header-section-number">2.2.3</span> Observation model and nowcast</a></li>
  <li><a href="#model-formulations" id="toc-model-formulations" class="nav-link" data-scroll-target="#model-formulations"> <span class="header-section-number">2.2.4</span> Model formulations</a></li>
  </ul></li>
  <li><a href="#implementation" id="toc-implementation" class="nav-link" data-scroll-target="#implementation"> <span class="header-section-number">2.3</span> Implementation</a></li>
  <li><a href="#evaluation" id="toc-evaluation" class="nav-link" data-scroll-target="#evaluation"> <span class="header-section-number">2.4</span> Evaluation</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"> <span class="header-section-number">3</span> Results</a>
  <ul class="collapse">
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation"> <span class="header-section-number">3.1</span> Visualisation</a></li>
  <li><a href="#evaluation-1" id="toc-evaluation-1" class="nav-link" data-scroll-target="#evaluation-1"> <span class="header-section-number">3.2</span> Evaluation</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics"> <span class="header-section-number">3.3</span> Diagnostics</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"> <span class="header-section-number">4</span> Discussion</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"> <span class="header-section-number">5</span> Conclusion</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix"> <span class="header-section-number">6</span> Appendix</a>
  <ul class="collapse">
  <li><a href="#exploratory-analysis-of-dashboard-data" id="toc-exploratory-analysis-of-dashboard-data" class="nav-link" data-scroll-target="#exploratory-analysis-of-dashboard-data"> <span class="header-section-number">6.1</span> Exploratory analysis of dashboard data</a></li>
  <li><a href="#long-delays" id="toc-long-delays" class="nav-link" data-scroll-target="#long-delays"> <span class="header-section-number">6.2</span> Long delays</a></li>
  <li><a href="#test-specific-case-data" id="toc-test-specific-case-data" class="nav-link" data-scroll-target="#test-specific-case-data"> <span class="header-section-number">6.3</span> Test-specific case data</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Nowcasting COVID-19 incidence in England</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    Ryan Teo 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Mathematics of Real-World Systems CDT, Mathematics Institute, University of Warwick
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    
  </div>
  

</header>

<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<!--- Present the nature and scope of problem investigated --->
<p>During infectious disease outbreaks, epidemiological indicators such as the incidence of cases and hospitalisations are often used to assess changes in epidemic dynamics in real-time. However, these indicators often suffer from reporting delays, resulting in them appearing artificially low towards the present day. This results in newly reported indicators being a lagging indicator of past events.</p>
<!--- What else has been done for nowcasting --->
<p><span class="citation" data-cites="cox1989"><a href="#ref-cox1989" role="doc-biblioref">[1]</a></span></p>
<ul>
<li>parametric approach to predicting point processes in the presence of notification delays</li>
<li></li>
</ul>
<p><span class="citation" data-cites="lawless1994"><a href="#ref-lawless1994" role="doc-biblioref">[2]</a></span></p>
<ul>
<li>Nonparametric methods that are well-suited for when daily number of events are moderately large</li>
<li>Estimating reporting-delay probabilities from recent data</li>
<li>Incorporates unobservable random effects in reporting delays</li>
<li>Both allow for time-varying reporting-delay distributions</li>
</ul>
<p><span class="citation" data-cites="höhle2014"><a href="#ref-höhle2014" role="doc-biblioref">[3]</a></span></p>
<ul>
<li></li>
</ul>
<p><span class="citation" data-cites="schneble2021"><a href="#ref-schneble2021" role="doc-biblioref">[4]</a></span></p>
<p>One study <span class="citation" data-cites="seaman2022"><a href="#ref-seaman2022" role="doc-biblioref">[5]</a></span></p>
<p><span class="citation" data-cites="abbott2021"><a href="#ref-abbott2021" role="doc-biblioref">[6]</a></span></p>
<p><span class="citation" data-cites="günther2021"><a href="#ref-günther2021" role="doc-biblioref">[7]</a></span></p>
<!-- Objective -->
<p>In this study, we aim to evaluate the utility of semi-parametric nowcasting model formulations generated from publicly available data on COVID-19 cases by specimen date in England. Additionally, we aim to assess the impact of reporting structures (including weekends, bank holidays, and reporting schedules) on the accuracy of nowcasts.</p>
<p>This work has vital applications to the real world. Developing an understanding of the impact of changing reporting schedules, such as the recent decision by the UK Health Security Agency (UKHSA) to change from week-daily to weekly reporting on 1st July 2022, may be useful to data providers.</p>
</section>
<section id="methods" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Methods</h1>
<section id="data" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data"><span class="header-section-number">2.1</span> Data</h2>
<ul>
<li>New COVID-19 cases by specimen date</li>
<li>UK COVID-19 dashboard, containing archived data</li>
<li>Feb 2021 to present</li>
<li>Reported weekdaily until Jul 2022, then weekly</li>
<li>New cases data stratified by age and region, but right-truncated by 5 days and is unsuitable for estimating reporting delays</li>
</ul>
</section>
<section id="models" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="models"><span class="header-section-number">2.2</span> Models</h2>
<p>We adapt the notation used in previous approaches <span class="citation" data-cites="lawless1994"><a href="#ref-lawless1994" role="doc-biblioref">[2]</a></span> to describe the nowcasting of discrete count data. Let <span class="math inline">\(n_{t,d}\)</span> be the number of cases which are tested on day <span class="math inline">\(t\in \{0,...,T\}\)</span> and are reported with a delay of <span class="math inline">\(d\in\{0,...,D\}\)</span> days. <span class="math inline">\(D\)</span>, which represents the maximum delay that can occur, can theoretically be infinite, but here we set it to be finite for the model to be computationally feasible and identifiable. Furthermore, longer delays provide information too far in the past to be relevant. Specifically, we set <span class="math inline">\(D=7\)</span> days after estimating that x of cases by a specimen date were eventually reported by the 7th day after. The final observed count for day <span class="math inline">\(t\)</span> is thus <span class="math display">\[N_t = \sum_{d=0}^D n_{t,d}\]</span></p>
<p>We assume that for each reference date <span class="math inline">\(t\)</span>, the number of cases reported with a delay of <span class="math inline">\(d\)</span> follow a multinomial distribution with <span class="math inline">\(N_t\)</span> trials and a probability vector <span class="math inline">\(p_{t,d}\)</span> of length <span class="math inline">\(D\)</span>. The objective of nowcasting is to use information available up to time <span class="math inline">\(t\)</span> to estimate the components of <span class="math inline">\(p_{t,d}\)</span> jointly with the expected number of final notifications <span class="math inline">\((\lambda_t = \mathbb{E}[N_t])\)</span> and predict the final observed counts <span class="math inline">\(N_t\)</span>.</p>
<section id="expected-final-notifications" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="expected-final-notifications"><span class="header-section-number">2.2.1</span> Expected final notifications</h3>
<p>The expected final notifications are modelled as a first order random walk over time <span class="citation" data-cites="günther2021"><a href="#ref-günther2021" role="doc-biblioref">[7]</a></span>, specified as such</p>
<p><span class="math display">\[
\begin{aligned}
\log(\lambda_0) &amp;\sim N\left(\log(N_0+1),1\right), \\
\log(\lambda_t)|\lambda_{t-1} &amp;\sim N(\log(\lambda_{t-1}), \sigma^2)\\
\sigma^2 &amp;\sim \text{Half-Normal}(0,1)
\end{aligned}
\]</span></p>
</section>
<section id="delay-distribution" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="delay-distribution"><span class="header-section-number">2.2.2</span> Delay distribution</h3>
<p>The delay distribution <span class="math inline">\(p_{t,d}\)</span> is estimated using a discrete-time logistic hazard model <span class="math display">\[h_{t,d}=\mathbb{P}(\text{delay}=d|\text{delay} \geq d, W_{t,d})\]</span> where <span class="math inline">\(W_{t,d}\)</span> is decomposed into 2 components:</p>
<ol type="1">
<li>Hazard derived from a parametric delay distribution <span class="math inline">\(\gamma_{t,d}\)</span> dependent on covariates at time of reference</li>
<li>Hazard dependent on covariates referenced to the time of report <span class="math inline">\(\epsilon_{t,d}\)</span></li>
</ol>
<section id="parametric-hazard-at-reference-time" class="level4">
<h4 class="anchored" data-anchor-id="parametric-hazard-at-reference-time">Parametric hazard at reference time</h4>
<p>The first component <span class="math inline">\(\gamma_{t,d}\)</span> can be thought of as the probability of reporting <span class="math inline">\(p'_{t,d}\)</span> at a given time <span class="math inline">\(t\)</span> if it followed a parametric distribution. Here, the probability follows a discretised log normal distribution as such</p>
<p><span class="math display">\[
\begin{aligned}
p'_{t,d} &amp;\sim \text{LogNormal}(\gamma_t,v_t)\\
\gamma_t &amp;= \mu_0 + \alpha_\mu X_\gamma+\beta_\mu Z_\gamma\\
v_t &amp;= \exp\left(v_0 + \alpha_v X_\gamma + \beta_v Z_\gamma\right)
\end{aligned}
\]</span></p>
<p>The distribution is normalised so it sums to 1. The resulting parametric logit hazard, which is the probability of report at a given time given that it has not already been reported for this component of the model is <span class="math display">\[\gamma_{t,d} = \text{logit}\left(\frac{p'_{t,d}}{\left(1-\sum_{d'=0}^{d-1}p'_{t,d'}\right)}\right)\]</span></p>
</section>
<section id="non-parametric-hazard-at-report-times" class="level4">
<h4 class="anchored" data-anchor-id="non-parametric-hazard-at-report-times">Non-parametric hazard at report times</h4>
<p>Non-parametric effects by report dates are represented by non-distributional logit hazard components for the respective times defined using an intercept and arbitrary shared covariates with fixed <span class="math inline">\(\alpha_\epsilon\)</span> and random <span class="math inline">\(\beta_\epsilon\)</span> coefficients</p>
<p><span class="math display">\[
\begin{aligned}
\epsilon_{t,d} &amp;= \alpha_\epsilon X_\epsilon + \beta_\epsilon Z_\epsilon
\end{aligned}
\]</span></p>
<p>The overall hazard for each reference time and delay is then <span class="math display">\[\text{logit}(h_{t,d}) = \gamma_{t,d}+\epsilon_{t,d}\]</span> where the hazard on the final day has been assumed to be 1, i.e.&nbsp;<span class="math inline">\(h_{t,D}=1\)</span> to enforce the constraint that all reported observations are reported within the specified maximum delay. The probability of a report for a given delay, reference time is then as follows</p>
<p><span class="math display">\[
\begin{aligned}
p_{t,0} &amp;= h_{t,0} \\
p_{t,d} &amp;= \left(1 - \sum_{d'=0}^{d-1} p_{t,d'}\right)\times h_{t,d}
\end{aligned}
\]</span></p>
<p>All fixed <span class="math inline">\(\alpha\)</span> and random <span class="math inline">\(\beta\)</span> coefficients have standard normal priors by default, while pooled standard deviations have standard half-normal priors.</p>
</section>
</section>
<section id="observation-model-and-nowcast" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="observation-model-and-nowcast"><span class="header-section-number">2.2.3</span> Observation model and nowcast</h3>
<p>The product of the expected final notifications for each reference time <span class="math inline">\(t\)</span> and the probability of reporting for each day of delay <span class="math inline">\(p_{t,d}\)</span> now returns the expected notifications by <span class="math inline">\(t\)</span> and reporting delay.</p>
<p>We assume a negative binomial observation model with a joint overdispersion parameter with a standard half normal prior on the inverse square root of the overdispersion. A nowcast of final observed notifications at each reference time <span class="math inline">\(t\)</span> can be obtained by taking the sum of posterior estimates for both unobserved and observed notifications for that reference time.</p>
<p><span class="math display">\[
\begin{aligned}
n_{t,d}\ |\  \gamma_{t,d}, p_{t,d} &amp;\sim \text{NegBin}(\lambda_t\times p_{t,d}, \phi),\quad t=1,...,T\\
\frac{1}{\sqrt{\phi}} &amp;\sim \text{Half-Normal}(0,1) \\
N_t &amp;= \sum_{d=0}^D n_{t,d}
\end{aligned}
\]</span></p>
</section>
<section id="model-formulations" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="model-formulations"><span class="header-section-number">2.2.4</span> Model formulations</h3>
<table class="table">
<thead>
<tr class="header">
<th>Model</th>
<th>Reporting Delays</th>
<th>Reporting Schedule</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Fixed</td>
<td>Week Daily</td>
</tr>
<tr class="even">
<td>2</td>
<td>Weekend</td>
<td>Week Daily</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Day of Week &amp; Holidays</td>
<td>Week Daily</td>
</tr>
<tr class="even">
<td>4</td>
<td>Day of Week &amp; Holidays</td>
<td>Weekly</td>
</tr>
</tbody>
</table>
<ul>
<li>Simulated 4 chains for 1,000 iterations and 1,000 for warm-up</li>
<li>Analysis was carried out using <code>R</code> version 4.1.0 <span class="citation" data-cites="rcoreteam2022"><a href="#ref-rcoreteam2022" role="doc-biblioref">[8]</a></span></li>
<li>Implemented using the <code>epinowcast</code> package version 0.1.0</li>
<li>Source code is available on GitHub</li>
</ul>
</section>
</section>
<section id="implementation" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="implementation"><span class="header-section-number">2.3</span> Implementation</h2>
</section>
<section id="evaluation" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="evaluation"><span class="header-section-number">2.4</span> Evaluation</h2>
<ul>
<li>Metric needs to be able to evaluate predictions provided in an interval or quantile format</li>
<li>Interval Score <span class="citation" data-cites="gneiting2007"><a href="#ref-gneiting2007" role="doc-biblioref">[9]</a></span></li>
</ul>
<p><span class="math display">\[\text{IS}_\alpha(F,y) = (u-l)+\frac{2}{\alpha}\times (l-y)\times \mathbb{I}(y&lt;l) + \frac{2}{\alpha}\times(y-u)\times\mathbb{I}(y&gt;u)\]</span></p>
<ul>
<li>Weighted Interval Score <span class="citation" data-cites="bracher2021"><a href="#ref-bracher2021" role="doc-biblioref">[10]</a></span> is composed of dispersion, overprediction, and underprediction.</li>
</ul>
<p><span class="math display">\[\text{WIS}_{\alpha_{\{0:K\}}}(F,y)=\frac{1}{K+1/2}\times\left(w_0\times |y-m| + \sum_{k-1}^K\{w_k\times\text{IS}_{\alpha_k}(F,y)\}\right)\]</span></p>
<ul>
<li>Proper scoring rule, weighted interval score</li>
<li>Implemented by <code>scoringutils</code> package version 1.0.0 <span class="citation" data-cites="bosse"><a href="#ref-bosse" role="doc-biblioref">[11]</a></span></li>
</ul>
</section>
</section>
<section id="results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Results</h1>
<section id="visualisation" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="visualisation"><span class="header-section-number">3.1</span> Visualisation</h2>
<ul>
<li>Plot of nowcasts by estimation date</li>
</ul>
</section>
<section id="evaluation-1" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="evaluation-1"><span class="header-section-number">3.2</span> Evaluation</h2>
<ul>
<li>Comparison of models by Weighted Interval Score and its components</li>
</ul>
</section>
<section id="diagnostics" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="diagnostics"><span class="header-section-number">3.3</span> Diagnostics</h2>
</section>
</section>
<section id="discussion" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Discussion</h1>
<ul>
<li>Summarise project</li>
<li>Discuss strengths and limitations of evaluation
<ul>
<li>Limitations
<ul>
<li>Test types, dealing with removals</li>
<li>Specimen date <span class="math inline">\(\neq\)</span> onset date</li>
<li>Dependent on testing regime</li>
</ul></li>
</ul></li>
<li>Compare to literature</li>
<li>Discuss further work</li>
<li>Summarise conclusions</li>
</ul>
</section>
<section id="conclusion" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusion</h1>
<ul>
<li>Summarise findings</li>
<li>Restate relevance to current literature</li>
<li>Explain why this matters</li>
</ul>
</section>
<section id="appendix" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Appendix</h1>
<section id="exploratory-analysis-of-dashboard-data" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="exploratory-analysis-of-dashboard-data"><span class="header-section-number">6.1</span> Exploratory analysis of dashboard data</h2>
<ul>
<li>Describe the change in mean reporting delay over time</li>
<li>Motivate the choice of time frame chosen in study?</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/cases-delay-england.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">COVID-19 cases in England by proportion of delay</figcaption><p></p>
</figure>
</div>
<p>(top) New cases by specimen date. Colors represent the delay during which cases were reported. (bottom) Proportion of new cases that are reported by varying delays. Black line represents mean delay.</p>
</section>
<section id="long-delays" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="long-delays"><span class="header-section-number">6.2</span> Long delays</h2>
<ul>
<li>This section illustrates how long reporting delays can be in real-world data</li>
<li>convince reader that extra-long delays are caused by logistical issues rather than factors affecting transmission and can be ignored</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/long-delay-dist.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Distribution of long delays</figcaption><p></p>
</figure>
</div>
<p>(left) The frequency of updates by specimen date and delay. The hue intensity reflects the number of updates made to the number of new cases on each specimen date with a delay indicated by the y-axis. The red diagonal line represents the maximum possible delay for each specimen date. (right) The number of updates made to past data on each reporting date. The red dotted lines represent two significant change points: the left marks when the linearly increasing number of updates ends, and the right highlights a particular reporting date on which there was an unusually large number of updates made to past data.</p>
<p><img src="images/cases-delay-dist.png" class="img-fluid" alt="Distribution of reporting delays"> (left) The mean proportion of cases reported with a delay <span class="math inline">\(d\)</span> for any specimen date, with 95% confidence intervals. (right) The mean proportion of cases reported by a delay <span class="math inline">\(d\)</span> for any specimen date, with 95% confidence intervals.</p>
<p>The distribution of reporting delays is right-skewed, which has a the greatest mean proportion at <span class="math inline">\(d=2\)</span>. Cumulatively, 97.4% of cases are reported by day <span class="math inline">\(d=7\)</span>. This suggests that it would be practical to take a maximum delay to be <span class="math inline">\(d&gt;7\)</span>.</p>
</section>
<section id="test-specific-case-data" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="test-specific-case-data"><span class="header-section-number">6.3</span> Test-specific case data</h2>
<ul>
<li>Explain that data on new cases is the sum of three separate data streams</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/delay-dist-test-type.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Distribution of reporting delays by test type</figcaption><p></p>
</figure>
</div>
<p>The majority of cases reported initially are confirmed by LFDs whilst PCR results experience a longer lag. Due to false positives, the cases confirmed by LFDs also update in the negative direction. Lastly, the proportion of cases confirmed by LFD and PCR within 3 days forms the smallest proportion of total cases reported and is slightly less right skewed than PCR only cases. This is consistent with the understanding that the reporting lags for both a LFD and a PCR test are expected to be larger than just a PCR test.</p>
<!-- Sample output of 7-day nowcast conducted in September 2021. Triangles represent eventually reported cases, while points represent the number of cases reported on the first day. Solid and dotted lines represent the mean and median nowcast, and the darker and lighter shaded regions represent the 90% and 30% confidence intervals. -->

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="doc-bibliography">
<div id="ref-cox1989" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">D. Cox and G. Medley, <span>“A process of events with notification delay and the forecasting of AIDS,”</span> <em>Philosophical transactions of the Royal Society of London. Series B, Biological sciences</em>, vol. 325, pp. 135–45, Oct. 1989, doi: <a href="https://doi.org/10.1098/rstb.1989.0078">10.1098/rstb.1989.0078</a>.</div>
</div>
<div id="ref-lawless1994" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">J. f. Lawless, <span>“Adjustments for reporting delays and the prediction of occurred but not reported events,”</span> <em>Canadian Journal of Statistics</em>, vol. 22, no. 1, pp. 15–31, 1994, doi: <a href="https://doi.org/10.2307/3315826.n1">10.2307/3315826.n1</a>.</div>
</div>
<div id="ref-höhle2014" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">M. Höhle and M. an der Heiden, <span>“Bayesian nowcasting during the STEC O104:H4 outbreak in Germany, 2011,”</span> <em>Biometrics</em>, vol. 70, no. 4, pp. 993–1002, 2014, doi: <a href="https://doi.org/10.1111/biom.12194">10.1111/biom.12194</a>.</div>
</div>
<div id="ref-schneble2021" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">M. Schneble, G. De Nicola, G. Kauermann, and U. Berger, <span>“Nowcasting fatal COVID-19 infections on a regional level in Germany,”</span> <em>Biometrical Journal</em>, vol. 63, no. 3, pp. 471–489, 2021, doi: <a href="https://doi.org/10.1002/bimj.202000143">10.1002/bimj.202000143</a>.</div>
</div>
<div id="ref-seaman2022" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">S. R. Seaman, P. Samartsidis, M. Kall, and D. De Angelis, <span>“Nowcasting COVID-19 deaths in England by age and region,”</span> <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, vol. n/a, no. n/a, Jun. 2022, doi: <a href="https://doi.org/10.1111/rssc.12576">10.1111/rssc.12576</a>.</div>
</div>
<div id="ref-abbott2021" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">S. Abbott, <em>Epinowcast: Hierarchical nowcasting of right censored epidemological counts</em>. 2021.</div>
</div>
<div id="ref-günther2021" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">F. Günther, A. Bender, K. Katz, H. Küchenhoff, and M. Höhle, <span>“Nowcasting the COVID-19 pandemic in Bavaria,”</span> <em>Biometrical Journal</em>, vol. 63, no. 3, pp. 490–502, 2021, doi: <a href="https://doi.org/10.1002/bimj.202000112">10.1002/bimj.202000112</a>.</div>
</div>
<div id="ref-rcoreteam2022" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">R Core Team, <em>R: A language and environment for statistical computing</em>. Vienna, Austria: R Foundation for Statistical Computing, 2022. Available: <a href="https://www.R-project.org/">https://www.R-project.org/</a></div>
</div>
<div id="ref-gneiting2007" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline">T. Gneiting and A. E. Raftery, <span>“Strictly proper scoring rules, prediction, and estimation,”</span> <em>Journal of the American Statistical Association</em>, vol. 102, no. 477, pp. 359–378, Mar. 2007, doi: <a href="https://doi.org/10.1198/016214506000001437">10.1198/016214506000001437</a>.</div>
</div>
<div id="ref-bracher2021" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">J. Bracher, E. L. Ray, T. Gneiting, and N. G. Reich, <span>“Evaluating epidemic forecasts in an interval format,”</span> <em>PLOS Computational Biology</em>, vol. 17, no. 2, p. e1008618, Feb. 2021, doi: <a href="https://doi.org/10.1371/journal.pcbi.1008618">10.1371/journal.pcbi.1008618</a>.</div>
</div>
<div id="ref-bosse" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">N. I. Bosse, H. Gruson, A. Cori, E. van Leeuwen, S. Funk, and S. Abbott, <span>“Evaluating forecasts with scoringutils in r,”</span> doi: <a href="https://doi.org/10.48550/arXiv.2205.07090">10.48550/arXiv.2205.07090</a>.</div>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>