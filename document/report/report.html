<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.619">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Nowcasting COVID-19 incidence in England</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"> <span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective"> <span class="header-section-number">1.1</span> Objective</a></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"> <span class="header-section-number">2</span> Methods</a>
  <ul class="collapse">
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset"> <span class="header-section-number">2.1</span> Dataset</a></li>
  <li><a href="#nowcasting-model" id="toc-nowcasting-model" class="nav-link" data-scroll-target="#nowcasting-model"> <span class="header-section-number">2.2</span> Nowcasting model</a>
  <ul class="collapse">
  <li><a href="#expected-final-notifications" id="toc-expected-final-notifications" class="nav-link" data-scroll-target="#expected-final-notifications"> <span class="header-section-number">2.2.1</span> Expected final notifications</a></li>
  <li><a href="#delay-distribution" id="toc-delay-distribution" class="nav-link" data-scroll-target="#delay-distribution"> <span class="header-section-number">2.2.2</span> Delay distribution</a></li>
  </ul></li>
  <li><a href="#scoring-rules" id="toc-scoring-rules" class="nav-link" data-scroll-target="#scoring-rules"> <span class="header-section-number">2.3</span> Scoring rules</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"> <span class="header-section-number">3</span> Results</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"> <span class="header-section-number">4</span> Discussion</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"> <span class="header-section-number">5</span> Conclusion</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Nowcasting COVID-19 incidence in England</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<!--- Present the nature and scope of problem investigated --->
<p>Epidemiological indicators often suffer from reporting delays, including delays between disease onset, testing, and reporting. This results in newly reported indicators being a lagging indicator of past events.</p>
<!--- Literature review --->
<p><span class="citation" data-cites="höhle2014">(<a href="#ref-höhle2014" role="doc-biblioref">Höhle and Heiden 2014</a>)</span></p>
<p><span class="citation" data-cites="lawless1994">(<a href="#ref-lawless1994" role="doc-biblioref">Lawless 1994</a>)</span></p>
<p><span class="citation" data-cites="schneble2021">(<a href="#ref-schneble2021" role="doc-biblioref">Schneble et al. 2021</a>)</span></p>
<p><span class="citation" data-cites="seaman2022">(<a href="#ref-seaman2022" role="doc-biblioref">Seaman et al. 2022</a>)</span></p>
<p><span class="citation" data-cites="abbott2021">(<a href="#ref-abbott2021" role="doc-biblioref">Abbott 2021</a>)</span></p>
<p><span class="citation" data-cites="günther2021">(<a href="#ref-günther2021" role="doc-biblioref">Günther et al. 2021</a>)</span></p>
<p><img src="images/nowcast.png" class="img-fluid" data-fig-align="center" alt="7-day average new COVID-19 cases by specimen date"> Colors represent data as it was reported at various reporting dates.</p>
<section id="objective" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="objective"><span class="header-section-number">1.1</span> Objective</h2>
<p>The objective of this paper is to nowcast the number of new COVID-19 cases by specimen date in England.</p>
</section>
</section>
<section id="methods" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Methods</h1>
<section id="dataset" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="dataset"><span class="header-section-number">2.1</span> Dataset</h2>
<ul>
<li>UK COVID-19 dashboard, containing archived data</li>
<li>Feb 2021 to present</li>
<li>Reported weekdaily until Jul 2022, then weekly</li>
</ul>
</section>
<section id="nowcasting-model" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="nowcasting-model"><span class="header-section-number">2.2</span> Nowcasting model</h2>
<p>Consider the distribution of notifications <span class="math inline">\(n_{gtd}\)</span> by time of reference <span class="math inline">\(t\)</span> and reporting delay <span class="math inline">\(d\)</span> conditional on the final observed count <span class="math inline">\(N_{gt}\)</span> for each dataset <span class="math inline">\(g\)</span>, such that <span class="math display">\[N_{gt}=\sum_{d=0}^Dn_{gtd}\]</span> where <span class="math inline">\(D\)</span> represents the maximum delay between the time of reference and time of report. Theoretically, <span class="math inline">\(D\)</span> can be infinite, but in practice and for operational purposes, it is set to be a finite value. For each dataset <span class="math inline">\(g\)</span>, the notifications which occur at <span class="math inline">\(t\)</span> are summed to follow a multinomial distribution with <span class="math inline">\(N_{gt}\)</span> trials and a probability vector <span class="math inline">\(p_{gtd}\)</span> of length <span class="math inline">\(D\)</span>.</p>
<p>The objective of nowcasting is to predict the final observed counts <span class="math inline">\(N_{gt}\)</span> given available information up to time <span class="math inline">\(t\)</span>. To do this, it is necessary to estimate the probability vector <span class="math inline">\(p_{gtd}\)</span> jointly with the expected number of final notifications <span class="math inline">\(\lambda_{gt}=\mathbb{E}[N_{gt}]\)</span>.</p>
<section id="expected-final-notifications" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="expected-final-notifications"><span class="header-section-number">2.2.1</span> Expected final notifications</h3>
<p>The expected final notifications</p>
<span class="math display">\[\begin{aligned}
\log(\lambda_0) &amp;\sim N(\log(N_{g0}+1),1), \\
\log(\lambda_t)|\lambda_{t-1} &amp;\sim N(\log(\lambda_{t-1}), \sigma^2)\\
\sigma &amp;\sim N(0,1)
\end{aligned}\]</span>
</section>
<section id="delay-distribution" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="delay-distribution"><span class="header-section-number">2.2.2</span> Delay distribution</h3>
<p>The delay distribution <span class="math inline">\(p_{gtd}\)</span> is estimated using a discrete-time logistic hazard model <span class="math display">\[h_{gtd}=\mathbb{P}(\text{delay}=d|\text{delay} \geq d, W_{gtd})\]</span> where <span class="math inline">\(W_{gtd}\)</span> is decomposed into 3 components:</p>
<ol type="1">
<li>Hazard derived from a parametric delay distribution <span class="math inline">\(\gamma_{gtd}\)</span> dependent on covariates at time of reference</li>
<li>Hazard not derived from a parametric delay distribution <span class="math inline">\(\delta_{gtd}\)</span> dependent on covariates at time of reference</li>
<li>Hazard dependent on covariates referenced to the time of report <span class="math inline">\(\epsilon_{gtd}\)</span></li>
</ol>
<section id="parametric-hazard-at-reference-time" class="level4">
<h4 class="anchored" data-anchor-id="parametric-hazard-at-reference-time">Parametric hazard at reference time</h4>
<p>The first component <span class="math inline">\(\gamma_{gtd}\)</span> can be thought of as the probability of reporting <span class="math inline">\(p'_{gtd}\)</span> at a given time <span class="math inline">\(t\)</span> if it followed a parametric distribution. Here, the probability follows a discretised log normal distribution as such</p>
<span class="math display">\[\begin{aligned}
p'_{gtd} &amp;\sim \text{LogNormal}(\gamma_{gt},v_{gt})\\
\gamma_{gt} &amp;= \mu_0 + \alpha_\mu X_{\gamma}+\beta_\mu Z_\gamma\\
v_{gt} &amp;= \exp\left(v_0 + \alpha_v X_\gamma + \beta_v Z_\gamma\right)
\end{aligned}\]</span>
<p>The distribution is normalised so it sums to 1. The resulting parametric logit hazard, which is the probability of report at a given time given that it has not already been reported for this component of the model is <span class="math display">\[\gamma_{gtd} = \text{logit}\left(\frac{p'_{gtd}}{\left(1-\sum_{d'=0}^{d-1}p'_{gtd'}\right)}\right)\]</span></p>
</section>
</section>
</section>
<section id="scoring-rules" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="scoring-rules"><span class="header-section-number">2.3</span> Scoring rules</h2>
</section>
</section>
<section id="results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Results</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/cases-delay-england.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">COVID-19 cases in England by proportion of delay</figcaption><p></p>
</figure>
</div>
<p>(top) New cases by specimen date. Colors represent the delay during which cases were reported. (bottom) Proportion of new cases that are reported by varying delays. Black line represents mean delay.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/long-delay-dist.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Distribution of long delays</figcaption><p></p>
</figure>
</div>
<p>(left) The frequency of updates by specimen date and delay. The hue intensity reflects the number of updates made to the number of new cases on each specimen date with a delay indicated by the y-axis. The red diagonal line represents the maximum possible delay for each specimen date. (right) The number of updates made to past data on each reporting date. The red dotted lines represent two significant change points: the left marks when the linearly increasing number of updates ends, and the right highlights a particular reporting date on which there was an unusually large number of updates made to past data.</p>
<p><img src="images/cases-delay-dist.png" class="img-fluid" alt="Distribution of reporting delays"> (left) The mean proportion of cases reported with a delay <span class="math inline">\(d\)</span> for any specimen date, with 95% confidence intervals. (right) The mean proportion of cases reported by a delay <span class="math inline">\(d\)</span> for any specimen date, with 95% confidence intervals.</p>
<p>The distribution of reporting delays is right-skewed, which has a the greatest mean proportion at <span class="math inline">\(d=2\)</span>. Cumulatively, 97.4% of cases are reported by day <span class="math inline">\(d=7\)</span>. This suggests that it would be practical to take a maximum delay to be <span class="math inline">\(d&gt;7\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/delay-dist-test-type.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Distribution of reporting delays by test type</figcaption><p></p>
</figure>
</div>
<p>The majority of cases reported initially are confirmed by LFDs whilst PCR results experience a longer lag. Due to false positives, the cases confirmed by LFDs also update in the negative direction. Lastly, the proportion of cases confirmed by LFD and PCR within 3 days forms the smallest proportion of total cases reported and is slightly less right skewed than PCR only cases. This is consistent with the understanding that the reporting lags for both a LFD and a PCR test are expected to be larger than just a PCR test.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/sample%20output-01.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Sample output of 7-day nowcast conducted in September 2021. Triangles represent eventually reported cases, while points represent the number of cases reported on the first day. Solid and dotted lines represent the mean and median nowcast, and the darker and lighter shaded regions represent the 90% and 30% confidence intervals.</p>
</section>
<section id="discussion" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Discussion</h1>
<ul>
<li>Test types, dealing with removals</li>
<li>Specimen date <span class="math inline">\(\neq\)</span> onset date</li>
</ul>
</section>
<section id="conclusion" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusion</h1>
<ul>
<li>Summarise findings</li>
<li>Restate relevance to current literature</li>
<li>Explain why this matters</li>
<li>Express direction for future research</li>
</ul>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-abbott2021" class="csl-entry" role="doc-biblioentry">
Abbott, Sam. 2021. <em>Epinowcast: Hierarchical Nowcasting of Right Censored Epidemological Counts</em>.
</div>
<div id="ref-günther2021" class="csl-entry" role="doc-biblioentry">
Günther, Felix, Andreas Bender, Katharina Katz, Helmut Küchenhoff, and Michael Höhle. 2021. <span>“Nowcasting the COVID-19 Pandemic in Bavaria.”</span> <em>Biometrical Journal</em> 63 (3): 490–502. <a href="https://doi.org/10.1002/bimj.202000112">https://doi.org/10.1002/bimj.202000112</a>.
</div>
<div id="ref-höhle2014" class="csl-entry" role="doc-biblioentry">
Höhle, Michael, and Matthias an der Heiden. 2014. <span>“Bayesian Nowcasting During the STEC O104:H4 Outbreak in Germany, 2011.”</span> <em>Biometrics</em> 70 (4): 993–1002. <a href="https://doi.org/10.1111/biom.12194">https://doi.org/10.1111/biom.12194</a>.
</div>
<div id="ref-lawless1994" class="csl-entry" role="doc-biblioentry">
Lawless, J.f. 1994. <span>“Adjustments for Reporting Delays and the Prediction of Occurred but Not Reported Events.”</span> <em>Canadian Journal of Statistics</em> 22 (1): 15–31. <a href="https://doi.org/10.2307/3315826.n1">https://doi.org/10.2307/3315826.n1</a>.
</div>
<div id="ref-schneble2021" class="csl-entry" role="doc-biblioentry">
Schneble, Marc, Giacomo De Nicola, Göran Kauermann, and Ursula Berger. 2021. <span>“Nowcasting Fatal COVID-19 Infections on a Regional Level in Germany.”</span> <em>Biometrical Journal</em> 63 (3): 471–89. <a href="https://doi.org/10.1002/bimj.202000143">https://doi.org/10.1002/bimj.202000143</a>.
</div>
<div id="ref-seaman2022" class="csl-entry" role="doc-biblioentry">
Seaman, Shaun R., Pantelis Samartsidis, Meaghan Kall, and Daniela De Angelis. 2022. <span>“Nowcasting COVID-19 Deaths in England by Age and Region.”</span> <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> n/a (n/a). <a href="https://doi.org/10.1111/rssc.12576">https://doi.org/10.1111/rssc.12576</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>